import{j as s,g as o,V as h,c as N}from"./index-D3ZYKOMr.js";import{r as c}from"./icons-DbTSyZBX.js";import{I as x,S as k}from"./Select-BSdvxTLj.js";import{F as B}from"./FileInput-BqOq6VSn.js";import{D as L}from"./DefaultLoader-BRIWHAbz.js";import{u as P}from"./useInput-syuInLTh.js";const O=({options:e,name:a,label:r,values:n=[],onChange:m})=>s.jsxs("div",{children:[s.jsx("h2",{className:"font-semibold text-gray-700 mb-2",children:r}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:e.map((i,u)=>s.jsxs("label",{htmlFor:`${a}-${i.value}`,className:"flex items-center gap-2",children:[s.jsx("input",{onChange:m,name:a,id:`${a}-${i.value}`,value:i.value,type:"checkbox",defaultChecked:(n==null?void 0:n.includes(i.value))??!1,className:"form-checkbox text-primary h-5 w-5"}),s.jsx("span",{className:"text-gray-700",children:i.label})]},`${a}-${i.value}-${u}`))})]}),M=({type:e,loading:a,onClick:r,label:n})=>s.jsx("button",{type:e,onClick:r,disabled:a,className:"px-4 py-2 rounded-lg bg-primary hover:bg-primary/90 transition-all duration-300 text-white",children:a?s.jsx(L,{}):n}),_="accommodation-types",V={getAllRoomTypes:async()=>(await o.get(`/${_}`)).data,getRoomTypeById:async e=>(await o.get(`/${_}/${e}`)).data,store:async e=>(await o.post(`/${_}`,e)).data,patch:async(e,a)=>(await o.patch(`/${_}/${e}`,a)).data,put:async(e,a)=>(await o.put(`/${_}/${e}`,a)).data},b="inclusions",U={getAllInclusions:async()=>(await o.get(`/${b}`)).data,getInclusionById:async e=>(await o.get(`/${b}/${e}`)).data,store:async e=>(await o.post(`/${b}`,e)).data,patch:async(e,a)=>(await o.patch(`/${b}/${e}`,a)).data,put:async(e,a)=>(await o.put(`/${b}/${e}`,a)).data},w="rooms",E={getAllRooms:async()=>(await o.get(`/${w}`)).data,storeRoom:async e=>(await o.post(`/${w}`,e)).data,updateRoom:async(e,a)=>(await o.patch(`/${w}/${e}`,a)).data},W=({inclusions:e,roomTypes:a,defaultValues:r,action:n="add",idToEdit:m,onClose:i,refetch:u})=>{const[A,p]=c.useState(!1),y=c.useMemo(()=>e.map(d=>({value:d.id,label:d.inclusion_name})),[e]),f=c.useMemo(()=>a.map(d=>({value:d.id,label:d.accommodation_type_name})),[a]),{values:t,handleChange:g,errors:v,isValid:C,handleArrayChange:j,getPayload:S,reset:R,setDefaultValues:F}=P({room_name:{value:"",required:!0},accommodation_type_id:{value:"",required:!0,numbers:!0},description:{value:"",required:!0},day_night_tour_price:{value:"",required:!0,numbers:!0},overnight_price:{value:"",required:!0,numbers:!0},inclusion_ids:{value:[],required:!0},notes:{value:"",required:!1},images:{value:[],required:!0}});c.useEffect(()=>{r&&F(r)},[r]);const D=async d=>{var q,I;if(d.preventDefault(),!!C()){if(n==="add")try{p(!0),await E.storeRoom(S(t)),h.success("Accommodation added successfully"),R()}catch(l){if(l instanceof N){h.error((q=l==null?void 0:l.response)==null?void 0:q.data.message);return}h.error("Something went wrong. Please try again.")}finally{p(!1)}else if(n==="edit"){const l=S(t),T={...l,...Array.isArray(l.images)&&l.images.length===0?{images:void 0}:{images:l.images}};try{p(!0),await E.updateRoom(m,T),h.success("Accommodation update successfully"),u==null||u(),i==null||i(),R()}catch($){if($ instanceof N){h.error((I=$==null?void 0:$.response)==null?void 0:I.data.message);return}h.error("Something went wrong. Please try again.")}finally{p(!1)}}}};return s.jsxs("form",{onSubmit:D,className:`border border-gray-300 rounded-xl w-full ${n==="add"?"xl:w-1/2":""} p-5 flex flex-col gap-y-3`,children:[s.jsxs("h1",{className:"font-bold text-black ",children:[n==="add"?"Add":"Edit"," accommodation"]}),s.jsx(B,{label:"Upload accommodation image (5 images max)",name:"images",maxFiles:5,onChange:j}),s.jsx(x,{label:"Room Name",placeholder:"Room name",name:"room_name",value:t.room_name.value,onChange:g,error:v.room_name,required:t.room_name.required}),s.jsx(x,{name:"description",label:"Room Description",placeholder:"Room description",value:t.description.value,onChange:g,error:v.description,required:t.description.required}),s.jsx(k,{label:"Accommodation Type",name:"accommodation_type_id",options:f,value:t.accommodation_type_id.value,onChange:g}),s.jsx(O,{label:"Select from pre-defined inclusions",name:"inclusion_ids",options:y,values:t.inclusion_ids.value,onChange:j}),s.jsx(x,{name:"day_night_tour_price",label:"Day/Night tour price",placeholder:"Enter Day/Night tour price",value:t.day_night_tour_price.value,onChange:g,error:v.day_night_tour_price,required:t.day_night_tour_price.required}),s.jsx(x,{name:"overnight_price",label:"Overnight Tour Price",placeholder:"Overnight Tour Price",value:t.overnight_price.value,onChange:g,error:v.overnight_price,required:t.overnight_price.required}),s.jsx(x,{name:"notes",label:"Additional Notes",placeholder:"Additional notes (optional)",value:t.notes.value,onChange:g,error:v.notes,required:t.notes.required}),s.jsx(M,{type:"submit",loading:A,label:"Submit"})]})},X=()=>{const e=c.useRef(!1),[a,r]=c.useState(!1),[n,m]=c.useState(!1),[i,u]=c.useState([]),[A,p]=c.useState([]),y=c.useCallback(async()=>{try{r(!0);const t=await V.getAllRoomTypes();u((t==null?void 0:t.data)||[])}catch(t){console.error("Failed to fetch room types:",t)}finally{r(!1)}},[]),f=c.useCallback(async()=>{try{m(!0);const t=await U.getAllInclusions();p((t==null?void 0:t.data)||[])}catch(t){console.error("Failed to fetch inclusions:",t)}finally{m(!1)}},[]);return c.useEffect(()=>{e.current||(e.current=!0,y(),f())},[y,f]),{roomTypes:i,inclusions:A,fetchRoomLoading:a,fetchInclusionLoading:n,fetchAllRoomTypes:y,fetchAllInclusions:f}};export{V as A,U as I,W as a,X as u};
