import{e as j,h as y,j as e,L as b}from"./index-D3ZYKOMr.js";import{u as N}from"./useMessaging-CgRBnOAA.js";import{U as n,a as p,b as v,E as w,c as L,d as M,e as S}from"./icons-DbTSyZBX.js";import"./react-DbHEDQBy.js";import"./messageService-c5W-t2hR.js";const _=()=>{const{user:a,loading:o}=j(),{convoId:l}=y();if(o)return"Loading...";const{messageDivRef:d,conversationList:x,messages:i,conversationFetching:h,title:u,messageLoading:g,handleSendMessage:c,sendingMessage:m,message:r,setMessage:f}=N(a==null?void 0:a.id,l);return e.jsxs("div",{className:"flex h-[calc(100vh-6.5625rem)] bg-gray-100",children:[e.jsxs("div",{className:"w-full md:w-80 bg-white border-r border-gray-200 flex flex-col",children:[e.jsx("div",{className:" border-b border-gray-200",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Messages"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:h?"Loading...":x.map(s=>e.jsxs(b,{to:`/admin/messages/${s.id}`,className:`p-4 border-b border-gray-100 flex items-center gap-3 hover:bg-gray-50 cursor-pointer ${s.id===Number(l)?"bg-blue-50":""}`,children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(n,{className:"h-6 w-6 text-gray-500"})})}),e.jsx("div",{className:"min-w-0 flex items-center",children:e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:s.title})})]},s.id))})]}),e.jsx("div",{className:"hidden md:flex flex-col flex-1 bg-gray-50",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:"md:hidden",children:e.jsx(v,{className:"h-5 w-5 text-gray-500"})}),e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(n,{className:"h-5 w-5 text-gray-500"})}),e.jsx("div",{children:e.jsx("h2",{className:"text-md font-medium text-gray-900",children:u})})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("button",{className:"h-8 w-8 rounded-full flex items-center justify-center hover:bg-gray-100",children:e.jsx(w,{className:"h-5 w-5 text-gray-500"})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:g?"Loading...":i.map((s,t)=>s.user_id===(a==null?void 0:a.id)?e.jsx("div",{ref:t===i.length-1?d:null,className:"flex items-end justify-end gap-2 max-w-[80%] ml-auto",children:e.jsxs("div",{className:"bg-primary text-white rounded-lg rounded-br-none p-3 shadow-sm",children:[e.jsx("p",{className:"text-sm",children:s.body}),e.jsxs("div",{className:"flex items-center justify-end gap-1 mt-1",children:[e.jsx("span",{className:"text-xs",children:new Date(s.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}),e.jsx(L,{className:"h-3 w-3 text-blue-100"})]})]})},`me-${t}`):e.jsxs("div",{ref:t===i.length-1?d:null,className:"flex items-end gap-2 max-w-[80%]",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 flex-shrink-0 flex items-center justify-center",children:e.jsx(n,{className:"h-4 w-4 text-gray-500"})}),e.jsxs("div",{className:"bg-white rounded-lg rounded-bl-none p-3 shadow-sm",children:[e.jsx("p",{className:"text-gray-800 text-sm",children:s.body}),e.jsx("span",{className:"text-xs ",children:new Date(s.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})]},`sender-${t}`))}),e.jsx("div",{className:"p-4 bg-white border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:r,onChange:s=>f(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),r.trim()!==""&&!m&&c(r))},placeholder:"Type a message...",className:"w-full pl-4 pr-10 py-3 rounded-full border border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx("button",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(M,{className:"h-5 w-5 text-gray-400"})})]}),e.jsx("button",{onClick:()=>c(r),disabled:m,className:"h-10 w-10 rounded-full bg-primary flex items-center justify-center text-white hover:bg-primary/90",children:e.jsx(S,{className:"h-5 w-5"})})]})})]}):e.jsxs("div",{className:"text-center p-6",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(p,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a conversation"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Choose from your existing conversations."})]})})]})};export{_ as default};
