import{j as e,e as D,g as S,V as N,c as P,h as B,i as F}from"./index-D3ZYKOMr.js";import{r as i,C as R,S as _}from"./icons-DbTSyZBX.js";import{D as C}from"./DefaultLoader-BRIWHAbz.js";import{M as q}from"./Modal-C_lINF_8.js";import{I as k,S as E}from"./Select-BSdvxTLj.js";import{F as I}from"./FileInput-BqOq6VSn.js";import{u as A}from"./useInput-syuInLTh.js";import"./react-DbHEDQBy.js";/* empty css                       */const T=({accommodation:n})=>{var s;return n?e.jsxs("div",{className:"w-full md:1/2",children:[e.jsx("div",{className:"w-full aspect-video bg-primary rounded-xl  flex overflow-hidden mb-3 justify-center items-center relative",children:e.jsx("img",{className:"object-cover w-full h-full",src:`https://genevieve-dynamistic-jeanine.ngrok-free.dev/storage/uploads/images/${(s=n.room_images.find(l=>l.is_main_image))==null?void 0:s.file}`,alt:""})}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:n.room_images.filter(l=>!l.is_main_image).map((l,o)=>e.jsxs("div",{className:"w-full aspect-square bg-primary rounded-xl flex  overflow-hidden justify-center items-center relative",children:[e.jsx("img",{src:`https://genevieve-dynamistic-jeanine.ngrok-free.dev/storage/uploads/images/${l.file}`,alt:""}),e.jsx("p",{className:"text-white text-xs",children:l.file})]},o))})]}):e.jsx(C,{})},L=""+new URL("payment_method-O5TMwpi4.png",import.meta.url).href,$=({isAuthPage:n=!1,accommodation:s})=>{var w;if(!s)return e.jsx("div",{children:e.jsx(C,{})});const[l,o]=i.useState(!1),[p,h]=i.useState(!1),{user:r}=D(),{values:t,handleChange:f,isValid:b,getPayload:a,reset:d,handleArrayChange:y}=A({check_in:{value:"",required:!0},check_out:{value:"",required:!0},tour_type:{value:"",required:!0},receipt:{value:[],required:!0}}),c=i.useMemo(()=>{const g=new Date(t.check_in.value),u=new Date(t.check_out.value);return Math.round(Math.abs((u.getTime()-g.getTime())/(1e3*3600*24)))},[t.check_in.value,t.check_out.value]),m=i.useMemo(()=>t.tour_type.value==="day"?Number(s.day_night_tour_price):t.tour_type.value==="night"?Number(s.overnight_price):void 0,[t.tour_type.value]),x=i.useMemo(()=>{if(c&&m)return c*m},[c,m]),M=async g=>{var v;if(g.preventDefault(),!b())return;h(!0);const u=a(t);try{await S.post("/bookings",{...u,receipt:t.receipt.value[0],total_price:x,room_id:s.id,user_id:r==null?void 0:r.id}),N.success("Booking successful"),d(),o(!1)}catch(j){if(j instanceof P){N.error((v=j==null?void 0:j.response)==null?void 0:v.data.message);return}N.error("Something went wrong. Please try again.")}finally{h(!1)}};return e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 mb-2",children:s.room_name}),e.jsx("p",{className:"text-lg text-gray-600",children:((w=s.accommodation_type)==null?void 0:w.accommodation_type_name)??""})]})}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-8 text-base",children:s.description}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Day or Night Tour"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["₱",Number(s.day_night_tour_price)]}),e.jsx("span",{className:"text-sm text-gray-500",children:"per tour"})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3",children:"Overnight (22 Hours)"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["₱",Number(s.overnight_price)]}),e.jsx("span",{className:"text-sm text-gray-500",children:"per night"})]})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx("span",{className:"font-semibold",children:"Maximum Guests:"}),e.jsxs("span",{children:[s.accommodation_type.max_guests," ",s.accommodation_type.max_guests===1?"guest":"guests"]})]}),s.notes&&e.jsx("p",{className:"text-sm text-gray-600 italic border-l-4 border-gray-300 pl-4",children:s.notes})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"What's Included"}),e.jsx("ul",{className:"space-y-3",children:s.room_inclusions.map((g,u)=>e.jsxs("li",{className:"flex items-start gap-3 text-gray-700",children:[e.jsx("span",{className:"text-primary font-bold mt-1",children:"✓"}),e.jsx("span",{children:g.inclusion_name})]},u))})]}),n&&e.jsx("button",{type:"button",onClick:()=>o(!0),className:"w-full py-4 px-6 rounded-lg bg-primary text-white font-semibold text-lg hover:bg-primary/90 transition-colors shadow-md hover:shadow-lg",children:"Book Now"}),e.jsx(q,{isOpen:l,setIsOpen:o,className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-3xl text-gray-900 mb-3",children:"Make a New Booking"}),e.jsx("p",{className:"text-gray-600 leading-relaxed mb-5",children:"Before proceeding, please review the following important information:"}),e.jsxs("div",{className:"space-y-3 bg-gray-50 rounded-lg p-5 border border-gray-200",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"text-primary font-bold text-lg flex-shrink-0",children:"•"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"No Refund Policy"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"All bookings are final and non-refundable."})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"text-primary font-bold text-lg flex-shrink-0",children:"•"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"50% Minimum Payment"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"You are required to pay at least 50% of the total price to confirm your booking."})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"text-primary font-bold text-lg flex-shrink-0",children:"•"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Payment Method"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Please use ",e.jsx("span",{className:"font-semibold text-gray-900",children:"GCASH"})," for payment. This will allow us to validate your receipt quickly and securely."]})]})]})]})]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"By proceeding, you acknowledge and agree to the terms above."}),e.jsxs("form",{autoComplete:"off",onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 grid-col-1 gap-5",children:[e.jsx(k,{label:"Check-in Date",placeholder:"Check-in Date",name:"check_in",value:t.check_in.value,onChange:f,type:"date",required:!0}),e.jsx(k,{label:"Check-out Date",placeholder:"Check-out Date",name:"check_out",value:t.check_out.value,onChange:f,type:"date",required:!0})]}),e.jsx(E,{label:"Tour Type",name:"tour_type",options:[{value:"day",label:"Day"},{value:"night",label:"Night"}],value:t.tour_type.value,onChange:f}),e.jsx("div",{className:"border-t border-gray-200 pt-6",children:x!==void 0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-5",children:[e.jsx("p",{className:"text-gray-700 mb-2",children:"Total Price"}),e.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:["₱",x.toLocaleString()]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-5",children:[e.jsx("p",{className:"text-gray-700 mb-2",children:"Minimum 50% Payment Required"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["₱",(x*.5).toLocaleString()]})]})]})}),x!==void 0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Scan the QR code below to send your payment via GCash, then upload the receipt."}),e.jsx("div",{className:"flex items-center justify-center bg-gray-50 rounded-xl p-6 border border-gray-300",children:e.jsx("img",{src:L,alt:"payment method qr code",className:"w-full max-w-xs rounded-lg"})})]}),e.jsx(I,{label:"Transaction Receipt (GCASH)",name:"receipt",onChange:y,minimumAmount:Number((x*.5).toFixed(2)),maxFiles:1,isForGcash:!0}),e.jsx("button",{disabled:p,type:"submit",className:"w-full py-4 px-6 rounded-lg bg-primary text-white font-semibold text-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg",children:p?"Processing...":"Confirm Booking"})]})]})]})})]})},J=()=>{const{roomId:n}=B(),{user:s}=D(),[l,o]=i.useState(!1),[p,h]=i.useState(!1),[r,t]=i.useState(null),b=F().pathname.split("/")[1]==="users";return i.useEffect(()=>{(async()=>{try{o(!1),h(!0);const d=await S.get(`/public-rooms?id=${n}`);d.data.data.length<=0&&o(!0),t(d.data.data[0])}catch(d){console.error(d)}finally{h(!1)}})()},[n]),p?e.jsx("div",{className:"space-y-8 animate-pulse",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-5",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-lg h-96"}),e.jsxs("div",{className:"w-full md:w-80 space-y-4",children:[e.jsx("div",{className:"bg-gray-200 rounded-lg h-40"}),e.jsx("div",{className:"bg-gray-200 rounded-lg h-20"})]})]})}):l?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[e.jsx(R,{className:"w-16 h-16 text-gray-400"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-700",children:"Room Not Found"}),e.jsx("p",{className:"text-gray-500",children:"This room doesn't exist or has been removed."})]}):r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mb-12",children:[e.jsx(T,{accommodation:r}),e.jsx($,{accommodation:r,isAuthPage:b})]}),e.jsx("div",{className:"mb-10",children:e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Customer Reviews"}),r.avg_rating?e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 flex items-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-6xl font-bold text-blue-600",children:r.avg_rating}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(a=>e.jsx(_,{className:"w-5 h-5",fill:a<=Math.round(r.avg_rating)?"#3B82F6":"#E5E7EB",stroke:"none"},a))}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Based on ",e.jsx("span",{className:"font-semibold",children:r.feedbacks.length})," reviews"]})]}),e.jsxs("div",{className:"hidden md:flex flex-col gap-3 flex-1",children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold text-lg",children:"Excellent"})," overall experience from guests"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Guests consistently praise the cleanliness, comfort, and hospitality"})]})]}):e.jsx("div",{className:"bg-gray-50 rounded-2xl p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No reviews yet. Be the first to share your experience!"})})]})}),r.feedbacks.length>0?e.jsx("div",{className:"space-y-4",children:r.feedbacks.map((a,d)=>{var y;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"mb-4 pb-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:String(s==null?void 0:s.id)===String(a.user_id)?"You":(y=a.user)==null?void 0:y.name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(a.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(c=>e.jsx(_,{className:"w-5 h-5",fill:c<=Number(a.rate)?"#FBBF24":"#E5E7EB",stroke:"none"},c))})]})}),e.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:a.comment}),a.images&&a.images.length>0&&e.jsx("div",{className:"flex gap-3 mb-4 flex-wrap",children:a.images.map((c,m)=>e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center group cursor-pointer",children:e.jsx("img",{src:`https://genevieve-dynamistic-jeanine.ngrok-free.dev/storage/uploads/images/${c.image}`,alt:`Review image ${m+1}`,className:"w-full h-full object-cover group-hover:scale-110 transition-transform"})},m))}),a.response&&e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4 mt-4",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:"Management Response"}),e.jsx("p",{className:"text-sm text-blue-800",children:a.response.response})]})]},d)})}):e.jsx("div",{className:"bg-gray-50 rounded-xl p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No reviews yet. Book this room and share your experience!"})})]}):null};export{J as default};
